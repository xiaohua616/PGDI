#!/bin/bash
python fewshot_kd.py \
    --batch_size 256 \
    --lr 0.2 \
    --adv 1.33 \
    --oh 0.001 \
    --gpu 0 \
    --T 20 \
    --bn_mmt 0.9 \
    --warmup 20 \
    --epochs 200 \
    --dataset cifar100 \
    --method PGDI \
    --lr_z 0.015 \
    --lr_g 5e-3 \
    --teacher wrn40_2 \
    --student wrn16_1 \
    --reset_l0 200 \
    --reset_bn 200 \
    --logits_loss_type hybrid_kl_min_l2 \
    --teacher_feature_source all_conv \
    --guidance_loss_type mmd \
    --bn 5 \
    --synthesis_batch_size 512 \
    --seed 2 \
    --fewshot_n_per_class 5 \
    --real_fewshot_per_step 128 \
    --alpha_schedule cosine \
    --real_fewshot_schedule cosine \
    --alpha_initial 0.9 \
    --alpha_final_stage 0.2 \
    --real_fewshot_initial 256 \
    --real_fewshot_final_stage 8 \
    --guidance_loss_w 100 \
    --logits_guidance_w 1 \
    --mixed_distill_stop_epoch 100 \
    --log_tag "PGDI_config" \
    --save_dir "run/PGDI_config"